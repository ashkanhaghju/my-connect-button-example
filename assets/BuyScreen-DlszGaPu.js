const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/estimate-l1-fee-CpHrnYzu.js","assets/index-DbAt9A43.js","assets/index-Ca74PG3G.css","assets/sha256-Iz9hYrNU.js"])))=>i.map(i=>d[i]);
import{av as ee,a6 as se,aw as It,a8 as Ot,_ as Rt,ax as Dt,ay as dt,az as Pt,a as lt,aA as Lt,s as ut,f as Se,af as Mt,aa as je,aB as ue,aC as Nt,aD as _t,d as nt,aE as w,aF as t,aG as qt,aH as l,aI as $t,aJ as Ut,aK as Ht,aL as W,aM as ht,aN as H,aO as K,aP as Qt,aQ as Gt,aR as We,aS as ve,aT as mt,aU as R,aV as ye,aW as de,aX as N,aY as te,aZ as y,a_ as Fe,a$ as I,b0 as xt,b1 as Te,b2 as x,b3 as ge,b4 as $,b5 as X,b6 as Ae,b7 as L,b8 as ze,b9 as Ie,ba as Vt,bb as J,bc as V,bd as Kt,be as yt,bf as be,bg as Oe,bh as Re,bi as Yt,bj as Zt,a5 as Jt,bk as pe,an as Xt,bl as en,bm as ke,bn as tn,bo as De,bp as fe,bq as ft,br as Y,bs as jt,bt as gt,bu as nn,bv as Ee,bw as bt,bx as sn,by as an,bz as we,bA as on,bB as rn,bC as kt,bD as cn,bE as dn,bF as st,bG as wt,bH as ln,bI as Ct,bJ as un,bK as hn,bL as mn,bM as St,bN as xn,bO as yn,bP as fn,bQ as jn,bR as gn,bS as at,bT as bn,bU as Tt,bV as kn,bW as wn,bX as Cn,bY as Sn,bZ as Tn,b_ as An,b$ as pn,c0 as En,c1 as ot,c2 as Bn,c3 as Wn,c4 as vn}from"./index-DbAt9A43.js";import{decimals as Fn}from"./decimals-CWvuXMas.js";import{getCurrencyMetadata as zn}from"./getCurrencyMetadata-DATMTo0s.js";import"./decimals-DX5_IbVn.js";const In=ee({id:84532,name:"Base Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},blockExplorers:[{name:"Basescan",url:"https://sepolia.basescan.org",apiUrl:"https://api-sepolia.basescan.org/api"}],testnet:!0}),On=ee({id:8453,name:"Base",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},blockExplorers:[{name:"Basescan",url:"https://basescan.org",apiUrl:"https://api.basescan.org/api"}]}),Rn=ee({id:11155420,name:"OP Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},blockExplorers:[{name:"Blockscout",url:"https://optimism-sepolia.blockscout.com",apiUrl:"https://optimism-sepolia.blockscout.com/api"}],testnet:!0}),Dn=ee({id:10,name:"OP Mainnet",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},blockExplorers:[{name:"Optimism Explorer",url:"https://optimistic.etherscan.io",apiUrl:"https://api-optimistic.etherscan.io"}]}),Pn=ee({id:999999999,name:"Zora Sepolia",nativeCurrency:{decimals:18,name:"Zora Sepolia",symbol:"ETH"},blockExplorers:[{name:"Zora Sepolia Explorer",url:"https://sepolia.explorer.zora.energy/",apiUrl:"https://sepolia.explorer.zora.energy/api"}],testnet:!0}),Ln=ee({id:7777777,name:"Zora",nativeCurrency:{decimals:18,name:"Ether",symbol:"ETH"},blockExplorers:[{name:"Explorer",url:"https://explorer.zora.energy",apiUrl:"https://explorer.zora.energy/api"}]}),Mn=[On.id,In.id,Dn.id,Rn.id,Ln.id,Pn.id,34443,919,42220,44787,204,5611];function Nn(e){return Mn.includes(e.id)}async function _n(e){var c;const{transaction:n}=e,a=e.from??((c=e.account)==null?void 0:c.address)??void 0,s=await se(n.gas)||await It({transaction:n,from:a}),o=await Ot(n.client,n.chain),u=o.maxFeePerGas||o.gasPrice;if(!u)throw new Error(`Unable to determine gas price for chain ${n.chain.id}`);let i;if(Nn(n.chain)){const{estimateL1Fee:d}=await Rt(async()=>{const{estimateL1Fee:h}=await import("./estimate-l1-fee-CpHrnYzu.js");return{estimateL1Fee:h}},__vite__mapDeps([0,1,2,3]));i=await d({transaction:n})}else i=0n;const r=s*u+i;return{ether:Dt(r),wei:r}}async function it(e){const n=await dt(e);return Pt(n)}async function qn(e){try{const a=await lt(e.client)(Lt(),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:ut({fromAddress:e.fromAddress,toAddress:e.toAddress,chainId:e.chainId,tokenAddress:e.tokenAddress,amount:e.amount,purchaseData:e.purchaseData})});if(!a.ok){const u=await a.json();throw u&&"error"in u?u:new Error(`HTTP error! status: ${a.status}`)}const s=(await a.json()).result;return{transactionRequest:{chain:Se(s.transactionRequest.chainId),client:e.client,data:s.transactionRequest.data,to:s.transactionRequest.to,value:BigInt(s.transactionRequest.value),gas:BigInt(s.transactionRequest.gasLimit)},approval:s.approval?Mt({contract:je({client:e.client,address:s.approval.tokenAddress,chain:Se(s.approval.chainId)}),spender:s.approval.spenderAddress,amountWei:BigInt(s.approval.amountWei)}):void 0,fromAddress:s.fromAddress,toAddress:s.toAddress,paymentToken:s.paymentToken,processingFee:s.processingFee,estimatedGasCostUSDCents:s.estimatedGasCostUSDCents,client:e.client}}catch(n){throw console.error("Error getting buy with crypto transfer",n),n}}function $n(e,n){return ue({...n,queryKey:["buyWithCryptoQuote",e],queryFn:()=>{if(!e)throw new Error("Swap params are required");return Nt(e)},enabled:!!e,retry(a,s){if(a>3)return!1;try{const o=s.error;if(o.code==="MINIMUM_PURCHASE_AMOUNT"||o.statusCode===404||o.statusCode>=500)return!1}catch{return!0}return!0}})}async function Un(e){try{const a=await lt(e.client)(_t(),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:ut({toAddress:e.toAddress,fromCurrencySymbol:e.fromCurrencySymbol,toChainId:e.toChainId.toString(),toTokenAddress:e.toTokenAddress,fromAmount:e.fromAmount,toAmount:e.toAmount,maxSlippageBPS:e.maxSlippageBPS,isTestMode:e.isTestMode,purchaseData:e.purchaseData,fromAddress:e.fromAddress,toGasAmountWei:e.toGasAmountWei,preferredProvider:e.preferredProvider})});if(!a.ok){const s=await a.json();throw s&&"error"in s?s:new Error(`HTTP error! status: ${a.status}`)}return(await a.json()).result}catch(n){throw console.error("Error getting buy with fiat quote",n),n}}function Hn(e,n){return ue({...n,queryKey:["useBuyWithFiatQuote",e],queryFn:async()=>{if(!e)throw new Error("No params provided");return Un(e)},enabled:!!e,retry(a,s){if(a>3)return!1;try{const o=s.error;if(o.code==="MINIMUM_PURCHASE_AMOUNT"||o.statusCode===404||o.statusCode>=500)return!1}catch{return!0}return!0}})}function At(e){const n=e.toToken.chainId===e.onRampToken.token.chainId,a=nt(e.toToken.tokenAddress)===nt(e.onRampToken.token.tokenAddress);return!(n&&a)}const pt=w.forwardRef(function(n,a){return t.jsx(Qn,{ref:a,children:t.jsx(qt,{children:t.jsxs(l,{p:"lg",children:[t.jsx($t,{children:t.jsx(Ut,{type:"button","aria-label":"Close",onClick:n.close,children:t.jsx(Ht,{width:W.md,height:W.md,style:{color:"inherit"}})})}),n.children]})})})}),Qn=ht(e=>{const n=H();return{zIndex:1e4,borderTopLeftRadius:K.xl,borderTopRightRadius:K.xl,background:n.colors.modalBg,position:"absolute",bottom:0,left:0,right:0,animation:`${Gn} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.1)`,borderTop:`1px solid ${n.colors.borderColor}`}}),Gn=Qt`
  from {
    opacity: 0;
    transform: translateY(100px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
`,Et=ht(e=>({backgroundColor:H().colors.modalOverlayBg,zIndex:9999,position:"absolute",inset:0,animation:`${Gt} 400ms cubic-bezier(0.16, 1, 0.3, 1)`}));function Bt(){const[e,n]=w.useState(!1),a=w.useRef(null),s=w.useRef(null),o=w.useCallback(()=>new Promise(i=>{var r;if(a.current){const c={easing:"cubic-bezier(0.175, 0.885, 0.32, 1.1)",fill:"forwards",duration:300},d=a.current.animate([{transform:"translateY(100%)",opacity:0}],c);(r=s.current)==null||r.animate([{opacity:0}],c),d.onfinish=()=>i()}else i()}),[]),u=w.useCallback(async i=>{i?n(!0):(await o(),n(!1))},[o]);return w.useLayoutEffect(()=>{if(!e)return;const i=r=>{a.current&&r.target instanceof Node&&!a.current.contains(r.target)&&u(!1)};return requestAnimationFrame(()=>{document.addEventListener("click",i)}),()=>{document.removeEventListener("click",i)}},[e,u]),{drawerRef:a,drawerOverlayRef:s,setIsOpen:u,isOpen:e}}function Vn(e){var g,S,C,b,k,v;const{payUiOptions:n,supportedDestinations:a,client:s,onContinue:o,payerAccount:u}=e,i=H(),r=We(),c=n.metadata,d=n.paymentInfo,{data:h}=ve(d.chain),{data:f}=mt({client:s,address:d.sellerAddress}),j=ue({queryKey:["amount",d],queryFn:async()=>{let F=18;d.token&&!R(d.token)&&(F=await Fn({contract:je({address:d.token.address,chain:d.chain,client:s})}));let p;return"amountWei"in d?p=ye(d.amountWei,F):p=d.amount,p}}).data;if(!h||j===void 0)return t.jsx(de,{});const A=d.token?{...d.token,icon:((g=d.token)==null?void 0:g.icon)||((C=(S=a.find(F=>F.chain.id===d.chain.id))==null?void 0:S.tokens.find(F=>{var p;return F.address.toLowerCase()===((p=d.token)==null?void 0:p.address.toLowerCase())}))==null?void 0:C.icon)}:{address:N,name:h.nativeCurrency.name,symbol:h.nativeCurrency.symbol,icon:(b=h.icon)==null?void 0:b.url};return t.jsxs(l,{p:"lg",children:[t.jsx(te,{title:(c==null?void 0:c.name)||"Payment Details"}),t.jsx(y,{y:"lg"}),t.jsxs(l,{children:[c!=null&&c.image?t.jsx(Fe,{client:s,src:c==null?void 0:c.image,style:{width:"100%",borderRadius:I.md,backgroundColor:i.colors.tertiaryBg}}):r?t.jsxs(l,{flex:"row",center:"both",style:{padding:I.md,marginBottom:I.md,borderRadius:I.md,backgroundColor:i.colors.tertiaryBg},children:[t.jsx(xt,{size:W.xl,id:r.id,client:s}),t.jsx("div",{style:{flexGrow:1,borderBottom:"6px dotted",borderColor:i.colors.secondaryIconColor,marginLeft:I.md,marginRight:I.md}}),t.jsx(Te,{client:s,size:W.xl,chainIconUrl:(k=h.icon)==null?void 0:k.url})]}):null,t.jsx(y,{y:"md"}),t.jsxs(l,{flex:"row",children:[t.jsx(l,{flex:"column",expand:!0,children:t.jsx(x,{size:"md",color:"primaryText",weight:700,children:"Price"})}),t.jsx(l,{expand:!0,children:t.jsxs(l,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:[t.jsx(ge,{chain:d.chain,client:e.client,size:"sm",token:A}),t.jsxs(x,{color:"primaryText",size:"md",weight:700,children:[String($(Number(j),6))," ",A.symbol]})]})})]}),t.jsx(y,{y:"md"}),t.jsx(X,{}),t.jsx(y,{y:"md"}),t.jsxs(l,{flex:"row",children:[t.jsx(l,{flex:"column",expand:!0,children:t.jsx(x,{size:"xs",color:"secondaryText",children:"Network"})}),t.jsx(l,{expand:!0,children:t.jsxs(l,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:[t.jsx(Te,{chainIconUrl:(v=h.icon)==null?void 0:v.url,size:"xs",client:e.client}),t.jsx(x,{size:"xs",color:"secondaryText",style:{textAlign:"right"},children:h.name})]})})]}),t.jsx(y,{y:"sm"}),t.jsxs(l,{flex:"row",children:[t.jsx(l,{flex:"column",expand:!0,children:t.jsx(x,{size:"xs",color:"secondaryText",children:"Seller"})}),t.jsx(l,{expand:!0,children:t.jsx(l,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:t.jsx(x,{size:"xs",color:"secondaryText",style:{textAlign:"right"},children:f||Ae(d.sellerAddress)})})})]})]}),t.jsx(y,{y:"xl"}),u?t.jsx(L,{variant:"accent",fullWidth:!0,onClick:()=>{ze({event:"choose_payment_method_direct_payment_mode",client:s,walletAddress:u.address,walletType:r==null?void 0:r.id}),o(j,d.chain,A)},children:"Choose Payment Method"}):t.jsx("div",{children:t.jsx(Ie,{...e.connectOptions,client:s,theme:i,connectButton:{style:{width:"100%"}}})})]})}function Wt(e){const{estimatedSeconds:n,quoteIsLoading:a}=e;return t.jsxs(l,{bg:"tertiaryBg",flex:"row",borderColor:"borderColor",style:{borderRadius:K.md,borderTopLeftRadius:0,borderTopRightRadius:0,justifyContent:"space-between",alignItems:"center",borderWidth:"1px",borderStyle:"solid"},children:[t.jsxs(l,{flex:"row",center:"y",gap:"xxs",color:"accentText",p:"sm",children:[t.jsx(Vt,{width:W.sm,height:W.sm}),a?t.jsx(J,{height:V.xs,width:"50px",color:"borderColor"}):t.jsx(x,{size:"xs",color:"secondaryText",children:n!==void 0?`~${Kt(n)}`:"--"})]}),t.jsxs(L,{variant:"ghost",onClick:e.onViewFees,gap:"xs",children:[t.jsx(l,{color:"accentText",flex:"row",center:"both",children:t.jsx(Kn,{size:W.sm})}),t.jsx(x,{size:"xs",color:"secondaryText",children:"View Fees"})]})]})}const Kn=e=>t.jsxs("svg",{width:e.size,height:e.size,viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[t.jsx("path",{d:"M9.5 1.5H2.5C1.94772 1.5 1.5 1.94772 1.5 2.5V9.5C1.5 10.0523 1.94772 10.5 2.5 10.5H9.5C10.0523 10.5 10.5 10.0523 10.5 9.5V2.5C10.5 1.94772 10.0523 1.5 9.5 1.5Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),t.jsx("path",{d:"M4.5 7.5L7.5 4.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})]});function Yn(e){return t.jsxs(l,{bg:"tertiaryBg",borderColor:"borderColor",flex:"row",style:{borderRadius:K.md,borderBottomRightRadius:0,borderBottomLeftRadius:0,borderWidth:"1px",borderStyle:"solid",borderBottom:"none",flexWrap:"nowrap",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs(Zn,{variant:"ghost",onClick:e.onSelectCurrency,style:{minHeight:"64px",justifyContent:"flex-start",minWidth:"50%"},gap:"sm",children:[t.jsx(e.currency.icon,{size:W.md}),t.jsxs(l,{flex:"row",center:"y",gap:"xxs",color:"secondaryText",children:[t.jsx(x,{color:"primaryText",children:e.currency.shorthand}),t.jsx(yt,{width:W.sm,height:W.sm})]})]}),t.jsx("div",{style:{flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",alignItems:"flex-end",gap:I.xxs,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",justifyContent:"center",paddingRight:I.sm},children:e.isLoading?t.jsx(J,{width:"100px",height:V.lg}):t.jsx(x,{size:"lg",color:e.value?"primaryText":"secondaryText",children:e.value?`${$(Number(e.value),6)}`:"--"})})]})}const Zn=be(L)(()=>({"&[disabled]:hover":{borderColor:"transparent"}}));function Jn(e){const n=H(),[a,s]=w.useState(!1),o=3,u=a?e.balances:e.balances.slice(0,o);return t.jsxs(l,{bg:"tertiaryBg",style:{borderRadius:K.lg,border:`1px solid ${n.colors.borderColor}`},children:[t.jsx(l,{style:{padding:I.sm},children:t.jsx(le,{...e})}),t.jsx("div",{style:{borderTop:`1px solid ${n.colors.borderColor}`}}),t.jsx(l,{flex:"column",children:e.balances.length>0?t.jsxs(t.Fragment,{children:[u.map(i=>t.jsx(Xn,{client:e.client,onClick:()=>e.onClick(e.wallet,i.token,i.chain),tokenBalance:i,wallet:e.wallet},`${i.token.address}-${i.chain.id}`)),e.balances.length>o&&t.jsx(vt,{variant:"secondary",onClick:()=>s(!a),style:{justifyContent:"start"},children:t.jsx(x,{size:"xs",children:a?"Show less":"Show more"})})]}):t.jsx(l,{style:{padding:I.sm},children:t.jsx(x,{size:"sm",color:"secondaryText",children:"Not enough funds"})})})]})}function Xn(e){const{tokenBalance:n,wallet:a,onClick:s,client:o}=e,u=Oe(n.chain);return t.jsxs(vt,{onClick:()=>s(n.token,a),variant:"secondary",children:[t.jsx(ge,{token:n.token,chain:n.chain,size:"md",client:o}),t.jsxs(l,{flex:"column",gap:"3xs",children:[t.jsx(x,{size:"xs",color:"primaryText",children:n.token.symbol}),u&&t.jsx(x,{size:"xs",children:u.name})]}),t.jsx("div",{style:{flex:1}}),t.jsx(l,{flex:"row",center:"y",gap:"3xs",children:t.jsx(x,{size:"xs",color:"secondaryText",children:Re(n.balance,!0)})})]})}function le(e){const{client:n,address:a}=e,s=e.walletId,o=H(),u=mt({client:n,address:a}),i=u.data||Ae(a),r=Yt({client:n,ensName:u.data});return t.jsxs(l,{flex:"row",center:"y",gap:"sm",color:"secondaryText",children:[r.data?t.jsx(Fe,{src:r.data,width:e.iconSize?W[e.iconSize]:W.md,height:e.iconSize?W[e.iconSize]:W.md,style:{borderRadius:"100%",overflow:"hidden",border:`1px solid ${o.colors.borderColor}`},client:e.client}):s?t.jsx(xt,{id:s,size:e.iconSize||W.md,client:e.client}):t.jsx(l,{style:{width:W.md,height:W.md,borderRadius:"100%",overflow:"hidden",border:`1px solid ${o.colors.borderColor}`},children:t.jsx(Zt,{address:e.address,size:Number(W.md)})}),t.jsx(x,{size:e.textSize||"sm",color:"primaryText",children:i||Ae(e.address)})]})}const vt=be(L)(e=>{const n=H();return{background:n.colors.tertiaryBg,justifyContent:"flex-start",flexDirection:"row",padding:I.sm,gap:I.sm,"&:hover":{background:n.colors.secondaryButtonBg,transform:"scale(1.01)"},transition:"background 200ms ease, transform 150ms ease"}});function es(e){const{transaction:n,account:a,supportedDestinations:s}=e,[o,u]=w.useState();return w.useEffect(()=>{Promise.all([se(n.value),se(n.erc20Value),se(n.to),Jt(n)]).then(([i,r,c,d])=>{var h;u({value:i==null?void 0:i.toString(),erc20Value:(h=r==null?void 0:r.amountWei)==null?void 0:h.toString(),erc20Currency:r==null?void 0:r.tokenAddress,to:c,data:d})})},[n]),ue({queryKey:["transaction-cost",n.chain.id,a==null?void 0:a.address,o],queryFn:async()=>{var m,j,A;if(!a)throw new Error("No payer account found");const i=await se(n.erc20Value);if(i){const[g,S,C]=await Promise.all([pe({address:a.address,chain:n.chain,client:n.client,tokenAddress:i.tokenAddress}),zn({contract:je({address:i.tokenAddress,chain:n.chain,client:n.client})}),Be(n,a==null?void 0:a.address)]),b=i.amountWei,k=g;return{token:{address:i.tokenAddress,name:S.name,symbol:S.symbol,icon:(j=(m=s.find(F=>F.chain.id===n.chain.id))==null?void 0:m.tokens.find(F=>F.address.toLowerCase()===i.tokenAddress.toLowerCase()))==null?void 0:j.icon},decimals:S.decimals,walletBalance:k,gasCostWei:C,transactionValueWei:b}}const[r,c,d]=await Promise.all([pe({address:a.address,chain:n.chain,client:n.client}),Xt(n.chain),Be(n,a==null?void 0:a.address)]),h=r,f=await se(n.value)||0n;return{token:{address:N,name:c.nativeCurrency.name,symbol:c.nativeCurrency.symbol,icon:(A=c.icon)==null?void 0:A.url},decimals:18,walletBalance:h,gasCostWei:d,transactionValueWei:f}},enabled:!!n&&!!o,refetchInterval:()=>{if(!n.erc20Value)return 3e4}})}async function Be(e,n){try{const a=await _n({transaction:e,from:n}),s=a.wei/10n;return a.wei+s}catch{return n?await Be(e):2000000n*await en({client:e.client,chain:e.chain})}}function ts(e){var v;const{payUiOptions:n,client:a,payerAccount:s,supportedDestinations:o,onContinue:u}=e,{data:i,error:r,isLoading:c,refetch:d}=ve(n.transaction.chain),h=n.metadata,{data:f,error:m,isLoading:j,refetch:A}=es({transaction:n.transaction,account:s,supportedDestinations:o}),g=H(),S=We(),C=ke(),b=tn(S),k=De({address:C==null?void 0:C.address,chain:n.transaction.chain,tokenAddress:R((f==null?void 0:f.token)||fe)||f==null?void 0:f.token.address,client:e.client},{enabled:!!f});return j||c?t.jsx(de,{}):m||r?t.jsx(l,{style:{minHeight:"350px"},fullHeight:!0,flex:"row",center:"both",children:t.jsx(ft,{title:(m==null?void 0:m.message)||(r==null?void 0:r.message)||"Something went wrong",onTryAgain:m?A:d})}):!f||!i?t.jsx(de,{}):t.jsxs(l,{p:"lg",children:[t.jsx(te,{title:(h==null?void 0:h.name)||"Transaction"}),t.jsx(y,{y:"lg"}),t.jsxs(l,{children:[h!=null&&h.image?t.jsx(Fe,{client:a,src:h==null?void 0:h.image,style:{width:"100%",borderRadius:I.md,border:`1px solid ${g.colors.borderColor}`,backgroundColor:g.colors.tertiaryBg}}):C?t.jsxs(l,{flex:"column",gap:"sm",children:[t.jsx(x,{size:"sm",color:"danger",style:{textAlign:"center"},children:"Insufficient funds"}),t.jsxs(l,{flex:"row",style:{justifyContent:"space-between",padding:I.sm,marginBottom:I.sm,borderRadius:I.md,backgroundColor:g.colors.tertiaryBg,border:`1px solid ${g.colors.borderColor}`},children:[t.jsx(le,{address:C==null?void 0:C.address,iconSize:"md",client:a}),k.data?t.jsxs(l,{flex:"row",gap:"3xs",center:"y",children:[t.jsx(x,{size:"xs",color:"secondaryText",weight:500,children:Re(k.data,!1)}),t.jsx(Y,{token:f.token,chain:n.transaction.chain,size:"xs",color:"secondaryText"})]}):t.jsx(J,{width:"70px",height:V.xs})]})]}):null,t.jsx(y,{y:"md"}),t.jsxs(l,{flex:"row",children:[t.jsx(l,{flex:"column",expand:!0,children:t.jsx(x,{size:"md",color:"primaryText",weight:700,children:"Price"})}),t.jsx(l,{expand:!0,children:t.jsxs(l,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:[t.jsx(ge,{chain:n.transaction.chain,client:e.client,size:"sm",token:f.token}),t.jsxs(x,{color:"primaryText",size:"md",weight:700,children:[String($(Number(ye(f.transactionValueWei,f.decimals)),6))," ",f.token.symbol]})]})})]}),t.jsx(y,{y:"md"}),t.jsx(X,{}),t.jsx(y,{y:"md"}),t.jsxs(l,{flex:"row",children:[t.jsx(l,{flex:"column",expand:!0,children:t.jsx(x,{size:"xs",color:"secondaryText",children:"Gas Fees"})}),t.jsx(l,{expand:!0,children:t.jsx(l,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:t.jsx(x,{color:b?"success":"primaryText",size:"xs",children:b?"Sponsored":`${String($(Number(ye(f.gasCostWei,i.nativeCurrency.decimals)),6))} ${i.nativeCurrency.symbol}`})})})]}),t.jsx(y,{y:"sm"}),t.jsxs(l,{flex:"row",children:[t.jsx(l,{flex:"column",expand:!0,children:t.jsx(x,{size:"xs",color:"secondaryText",children:"Network"})}),t.jsx(l,{expand:!0,children:t.jsxs(l,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:[t.jsx(Te,{chainIconUrl:(v=i.icon)==null?void 0:v.url,size:"xs",client:e.client}),t.jsx(x,{size:"xs",color:"secondaryText",style:{textAlign:"right"},children:i.name})]})})]})]}),t.jsx(y,{y:"xl"}),s?t.jsx(L,{variant:"accent",fullWidth:!0,onClick:()=>{let F=f.transactionValueWei;f.token.address===N&&!b&&(F+=f.gasCostWei),ze({event:"choose_payment_method_transaction_mode",client:a,walletAddress:s.address,walletType:S==null?void 0:S.id}),u(ye(F,f.decimals),n.transaction.chain,f.token)},children:"Choose Payment Method"}):t.jsx("div",{children:t.jsx(Ie,{...e.connectOptions,client:a,theme:g,connectButton:{style:{width:"100%"}}})})]})}function ns(e){return t.jsxs(l,{children:[t.jsx(l,{p:"lg",children:t.jsx(te,{title:"Pay with",onBack:e.onBack})}),t.jsx(X,{}),t.jsx(y,{y:"lg"}),t.jsx(l,{flex:"column",gap:"xs",px:"lg",children:jt.map(n=>t.jsxs(ss,{fullWidth:!0,variant:"secondary",onClick:()=>e.onSelect(n),gap:"sm",children:[t.jsx(n.icon,{size:W.lg}),t.jsxs(l,{flex:"column",gap:"xxs",children:[t.jsx(x,{color:"primaryText",children:n.shorthand}),t.jsx(x,{size:"sm",children:n.name})]})]},n.shorthand))}),t.jsx(y,{y:"lg"})]})}const ss=be(L)(()=>{const e=H();return{background:e.colors.tertiaryBg,justifyContent:"flex-start",gap:I.sm,padding:I.sm,"&:hover":{background:e.colors.secondaryButtonBg,transform:"scale(1.01)"},transition:"background 200ms ease, transform 150ms ease"}});function Ft(e,n){const o=(window.innerHeight-750)/2,u=(window.innerWidth-500)/2;return window.open(`${e}&theme=${n}`,"thirdweb Pay",`width=500, height=750, top=${o}, left=${u}`)}function as(e){var c,d,h,f;const n=gt(),{openedWindow:a,onSuccess:s}=e,o=nn({intentId:e.intentId,client:e.client});let u="loading";((c=o.data)==null?void 0:c.status)==="ON_RAMP_TRANSFER_FAILED"||((d=o.data)==null?void 0:d.status)==="PAYMENT_FAILED"?u="failed":((h=o.data)==null?void 0:h.status)==="CRYPTO_SWAP_FALLBACK"?u="partialSuccess":((f=o.data)==null?void 0:f.status)==="ON_RAMP_TRANSFER_COMPLETED"&&(u="completed");const i=w.useRef(!1);w.useEffect(()=>{var m;i.current||!s||((m=o.data)==null?void 0:m.status)==="ON_RAMP_TRANSFER_COMPLETED"&&(i.current=!0,s(o.data))},[s,o.data]),w.useEffect(()=>{var m,j;!a||!o.data||(((m=o.data)==null?void 0:m.status)==="CRYPTO_SWAP_REQUIRED"||((j=o.data)==null?void 0:j.status)==="ON_RAMP_TRANSFER_COMPLETED")&&a.close()},[o.data,a]);const r=w.useRef(!1);return w.useEffect(()=>{var m;!r.current&&((m=o.data)==null?void 0:m.status)==="ON_RAMP_TRANSFER_COMPLETED"&&(r.current=!0,Ee(n))},[o.data,n]),w.useEffect(()=>{var m;((m=o.data)==null?void 0:m.status)==="CRYPTO_SWAP_REQUIRED"&&e.onShowSwapFlow(o.data)},[o.data,e.onShowSwapFlow]),t.jsxs(l,{p:"lg",children:[t.jsx(te,{title:e.title,onBack:e.onBack}),e.hasTwoSteps&&t.jsxs(t.Fragment,{children:[t.jsx(y,{y:"lg"}),t.jsx(bt,{steps:2,currentStep:1}),t.jsx(y,{y:"sm"}),t.jsxs(x,{size:"xs",children:["Step 1 of 2 - Buying ",e.quote.onRampToken.token.symbol," with"," ",e.quote.fromCurrencyWithFees.currencySymbol]})]}),t.jsx(os,{uiStatus:u,onDone:e.onDone,fiatStatus:o.data,client:e.client,transactionMode:e.transactionMode,quote:e.quote,isEmbed:e.isEmbed})]})}function os(e){const{uiStatus:n}=e,a=e.fiatStatus?sn(e.fiatStatus):void 0,s=e.fiatStatus&&e.fiatStatus.status!=="NOT_FOUND"?e.fiatStatus:void 0,o=e.quote.onRampToken,u=t.jsx(an,{client:e.client,token:s!=null&&s.source?{chainId:s.source.token.chainId,address:s.source.token.tokenAddress,symbol:s.source.token.symbol||"",amount:s.source.amount}:{chainId:o.token.chainId,address:o.token.tokenAddress,symbol:o.token.symbol,amount:o.amount},fiat:{amount:e.quote.fromCurrencyWithFees.amount,currencySymbol:e.quote.fromCurrencyWithFees.currencySymbol},statusMeta:s!=null&&s.source&&a?{color:a==null?void 0:a.color,text:a==null?void 0:a.status,txHash:s.source.transactionHash}:void 0});return t.jsxs(l,{children:[t.jsx(y,{y:"xl"}),n==="loading"&&t.jsxs(t.Fragment,{children:[t.jsx(y,{y:"md"}),t.jsx(l,{flex:"row",center:"x",children:t.jsx(we,{size:"xxl",color:"accentText"})}),t.jsx(y,{y:"md"}),t.jsx(x,{color:"primaryText",size:"lg",center:!0,children:"Buy Pending"}),t.jsx(y,{y:"sm"}),!on()&&t.jsx(x,{center:!0,children:"Complete the purchase in popup"}),t.jsx(y,{y:"xxl"}),u]}),n==="failed"&&t.jsxs(t.Fragment,{children:[t.jsx(y,{y:"md"}),t.jsx(l,{flex:"row",center:"x",children:t.jsx(rn,{size:W["3xl"]})}),t.jsx(y,{y:"lg"}),t.jsx(x,{color:"primaryText",size:"lg",center:!0,children:"Transaction Failed"}),t.jsx(y,{y:"xxl"}),u]}),n==="completed"&&t.jsxs(t.Fragment,{children:[t.jsx(y,{y:"md"}),t.jsx(l,{flex:"row",center:"x",color:"success",children:t.jsx(kt,{width:W["3xl"],height:W["3xl"]})}),t.jsx(y,{y:"md"}),t.jsx(x,{color:"primaryText",size:"lg",center:!0,children:"Buy Complete"}),e.fiatStatus&&e.fiatStatus.status!=="NOT_FOUND"&&t.jsxs(t.Fragment,{children:[t.jsx(y,{y:"xxl"}),u,t.jsx(y,{y:"sm"})]}),!e.isEmbed&&t.jsx(L,{variant:"accent",fullWidth:!0,onClick:e.onDone,children:e.transactionMode?"Continue Transaction":"Done"})]})]})}function is(e){const n=At(e.quote),[a,s]=w.useState(n?{id:"step-1"}:{id:"onramp-status"}),[o,u]=w.useState(e.openedWindow),i=w.useCallback(()=>{cn({intentId:e.quote.intentId,client:e.client}).then(r=>{e.onSuccess(r)})},[e.onSuccess,e.quote.intentId,e.client]);return a.id==="step-1"?t.jsx(dn,{title:e.title,client:e.client,onBack:e.onBack,partialQuote:st(e.quote),step:1,onContinue:()=>{const r=Ft(e.quote.onRampLink,e.theme);ze({event:"open_onramp_popup",client:e.client,walletAddress:e.payer.account.address,walletType:e.payer.wallet.id}),wt({type:"fiat",intentId:e.quote.intentId}),u(r),s({id:"onramp-status"})}}):a.id==="onramp-status"?t.jsx(as,{title:e.title,client:e.client,intentId:e.quote.intentId,onBack:e.onBack,hasTwoSteps:n,openedWindow:o,quote:e.quote,onDone:e.onDone,onShowSwapFlow:r=>{s({id:"postonramp-swap",data:r})},transactionMode:e.transactionMode,isEmbed:e.isEmbed,onSuccess:e.onSuccess}):a.id==="postonramp-swap"?t.jsx(ln,{title:e.title,status:a.data,quote:st(e.quote),client:e.client,onBack:e.onBack,onDone:e.onDone,onSwapFlowStarted:()=>{},transactionMode:e.transactionMode,isEmbed:e.isEmbed,payer:e.payer,onSuccess:i}):null}function rs(e){const{payOptions:n,supportedDestinations:a,toChain:s,toToken:o}=e;function u(){const h=a.find(j=>j.chain.id===s.id);if(!h)return{fiat:!1,swap:!1};const f=R(o)?N:o.address,m=h.tokens.find(j=>j.address.toLowerCase()===f.toLowerCase());return m?{fiat:m.buyWithFiatEnabled,swap:m.buyWithCryptoEnabled}:{fiat:!0,swap:!0}}const{fiat:i,swap:r}=u(),c=n.buyWithFiat!==!1&&i,d=n.buyWithCrypto!==!1&&r;return{buyWithFiatEnabled:c,buyWithCryptoEnabled:d}}const zt=ee({id:137,name:"Polygon",nativeCurrency:{name:"POL",symbol:"POL",decimals:18},blockExplorers:[{name:"PolygonScan",url:"https://polygonscan.com",apiUrl:"https://api.polygonscan.com/api"}]});function cs(e){var j,A,g,S;const{payOptions:n,supportedDestinations:a}=e,s=n==null?void 0:n.prefillBuy,o=Ct(),u=(s==null?void 0:s.amount)||"",[i,r]=w.useState(u),c=un(i,300),[d,h]=w.useState((s==null?void 0:s.chain)||n.mode==="transaction"&&((j=n.transaction)==null?void 0:j.chain)||n.mode==="direct_payment"&&((A=n.paymentInfo)==null?void 0:A.chain)||((g=a.find(C=>C.chain.id===(o==null?void 0:o.id)))==null?void 0:g.chain)||((S=a[0])==null?void 0:S.chain)||zt),[f,m]=w.useState((s==null?void 0:s.token)||n.mode==="direct_payment"&&n.paymentInfo.token||fe);return{toChain:d,setToChain:h,toToken:f,setToToken:m,tokenAmount:i,setTokenAmount:r,deferredTokenAmount:c}}function ds(e){var A,g,S,C,b,k;const{payOptions:n,supportedSources:a}=e,s=a!=null&&a.length?a[0]:void 0,[o,u]=w.useState(),i=n.buyWithCrypto!==!1&&((g=(A=n.buyWithCrypto)==null?void 0:A.prefillSource)==null?void 0:g.chain)||n.mode==="transaction"&&((S=n.transaction)==null?void 0:S.chain)||n.mode==="direct_payment"&&((C=n.paymentInfo)==null?void 0:C.chain),r=s!=null&&s.chain?s.chain:void 0,c=o||i||r||zt,[d,h]=w.useState(),f=n.buyWithCrypto!==!1&&((k=(b=n.buyWithCrypto)==null?void 0:b.prefillSource)==null?void 0:k.token)||n.mode==="direct_payment"&&n.paymentInfo.token;return{fromChain:c,setFromChain:u,fromToken:d||f||fe||fe,setFromToken:h}}function ls(e){var i,r;const{payOptions:n}=e,s=(n.buyWithFiat!==!1?(r=(i=n.buyWithFiat)==null?void 0:i.prefillSource)==null?void 0:r.currency:void 0)||us(),[o,u]=w.useState(jt.find(c=>c.shorthand===s)||hn);return{selectedCurrency:o,setSelectedCurrency:u}}function us(){try{const e=Intl.DateTimeFormat().resolvedOptions().timeZone.toLowerCase();return e.includes("london")?"GBP":e.includes("europe")?"EUR":e.includes("japan")?"JPY":e.includes("canada")?"CAD":"USD"}catch{return"USD"}}function hs(e){return e.length>10?"26px":e.length>6?"34px":"50px"}function ms(e){const{name:n}=Oe(e.chain),a=()=>{let s=e.value.replace(".","").length;return e.value.includes(".")&&(s+=.3),`calc(${`${Math.max(1,s)}ch`} + 6px)`};return t.jsxs(l,{children:[t.jsx("div",{onClick:s=>{var o;(o=s.currentTarget.querySelector("input"))==null||o.focus()},children:t.jsxs(l,{flex:"row",center:"both",gap:"xs",style:{flexWrap:"nowrap"},children:[t.jsx(mn,{variant:"outline",pattern:"^[0-9]*[.,]?[0-9]*$",inputMode:"decimal",tabIndex:-1,placeholder:"0",type:"text","data-placeholder":e.value==="",value:e.value||"0",disabled:e.freezeAmount,onClick:s=>{e.value===""&&s.currentTarget.setSelectionRange(s.currentTarget.value.length,s.currentTarget.value.length)},onChange:s=>{let o=s.target.value;o.startsWith(".")&&(o=`0${o}`);const u=Number(o);Number.isNaN(u)||(o.startsWith("0")&&!o.startsWith("0.")?e.onChange(o.slice(1)):e.onChange(o))},style:{border:"none",fontSize:hs(e.value),boxShadow:"none",borderRadius:"0",padding:"0",paddingBlock:"2px",fontWeight:600,textAlign:"right",width:a(),maxWidth:"calc(100% - 100px)"}}),t.jsx(Y,{token:e.token,chain:e.chain,size:"lg",color:"secondaryText"})]})}),!e.hideTokenSelector&&t.jsxs(t.Fragment,{children:[t.jsx(y,{y:"sm"}),t.jsx(l,{flex:"row",center:"x",children:t.jsxs(xs,{variant:"secondary",fullWidth:!0,style:{fontSize:V.sm},gap:"xxs",onClick:e.onSelectToken,disabled:e.freezeChainAndToken,children:[t.jsxs(l,{flex:"row",center:"y",gap:"sm",children:[t.jsx(ge,{token:e.token,chain:e.chain,size:"md",client:e.client}),t.jsxs(l,{flex:"column",style:{gap:"4px"},children:[t.jsx(Y,{token:e.token,chain:e.chain,size:"sm"}),n?t.jsx(x,{size:"xs",color:"secondaryText",children:n}):t.jsx(J,{width:"90px",height:V.xs})]})]}),t.jsx(yt,{width:W.sm,height:W.sm,style:{marginLeft:"auto"}})]})})]})]})}const xs=be(L)(()=>{const e=H();return{background:e.colors.tertiaryBg,border:`1px solid ${e.colors.borderColor}`,justifyContent:"flex-start",transition:"background 0.3s",padding:I.sm}});function ys(e){return t.jsx(l,{flex:"column",gap:"xs",style:{alignItems:"flex-start"},children:e.quote.processingFees.map(n=>{const a=$(Number(n.amount),6);return t.jsxs(l,{flex:"row",gap:"xxs",children:[t.jsxs(x,{color:"primaryText",size:"sm",children:[a===0?"~":"",a," ",n.token.symbol]}),t.jsxs(x,{color:"secondaryText",size:"sm",children:["($",(n.amountUSDCents/100).toFixed(2),")"]})]},`${n.token.chainId}_${n.token.tokenAddress}_${a}`)})})}function fs(e){return t.jsxs(l,{flex:"column",gap:"xs",children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx(x,{inline:!0,color:"secondaryText",children:"Amount"}),t.jsxs(x,{color:"primaryText",inline:!0,children:[$(Number(e.quote.fromCurrency.amount),2)," ",e.quote.fromCurrency.currencySymbol]})]}),e.quote.processingFees.map((n,a)=>{const s=$(Number(n.amount),6);return t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx(x,{inline:!0,color:"secondaryText",children:n.feeType==="NETWORK"?"Network Fee":"Processing Fee"}),t.jsxs(x,{color:"primaryText",inline:!0,children:[s===0?"~":""," ",s," ",n.currencySymbol]})]},a)}),t.jsx(y,{y:"xxs"}),t.jsx(X,{}),t.jsx(y,{y:"xxs"}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx(x,{inline:!0,color:"secondaryText",children:"Total"}),t.jsxs(x,{color:"primaryText",inline:!0,children:[$(Number(e.quote.fromCurrencyWithFees.amount),6)," ",e.quote.fromCurrencyWithFees.currencySymbol]})]})]})}function js(e){const n=H(),{name:a}=Oe(e.chain),s=De({address:e.payerAccount.address,chain:e.chain,tokenAddress:R(e.token)?void 0:e.token.address,client:e.client});return t.jsxs(l,{bg:"tertiaryBg",style:{borderRadius:K.lg,border:`1px solid ${n.colors.borderColor}`,...e.swapRequired?{borderBottom:"none",borderBottomLeftRadius:0,borderBottomRightRadius:0}:{}},children:[t.jsxs(l,{flex:"row",gap:"sm",style:{justifyContent:"space-between",padding:I.sm,borderBottom:`1px solid ${n.colors.borderColor}`},children:[t.jsx(le,{client:e.client,address:e.payerAccount.address}),s.data?t.jsxs(l,{flex:"row",gap:"3xs",center:"y",children:[t.jsx(x,{size:"xs",color:"secondaryText",weight:500,children:Re(s.data,!1)}),t.jsx(Y,{token:e.token,chain:e.chain,size:"xs",color:"secondaryText"})]}):t.jsx(J,{width:"70px",height:V.xs})]}),t.jsxs(l,{flex:"row",gap:"sm",style:{paddingInline:I.sm,paddingBlock:I.sm,minWidth:"50%",justifyContent:"flex-start",minHeight:"64px"},children:[t.jsx(St,{token:e.token,chain:e.chain,size:"md",client:e.client}),t.jsxs(l,{flex:"column",gap:"3xs",children:[e.isLoading?t.jsx(J,{width:"120px",height:V.md,color:"borderColor"}):t.jsxs(l,{flex:"row",gap:"xxs",center:"y",color:"primaryText",children:[t.jsx(x,{size:"md",color:e.value?"primaryText":"secondaryText",children:$(Number(e.value),6)||""}),t.jsx(Y,{token:e.token,chain:e.chain,size:"sm"})]}),a?t.jsx(x,{size:"xs",children:a}):t.jsx(J,{width:"90px",height:V.xs})]})]})]})}function gs(e){var r,c;const n=H(),a=xn(),s=!e.showAllWallets&&((r=e.wallets)==null?void 0:r.every(d=>a.includes(d))),o=ve(e.toChain),u=ke(),i=ue({queryKey:["wallets-and-balances",a.map(d=>{var h;return(h=d.getAccount())==null?void 0:h.address}),e.sourceSupportedTokens,e.toChain.id,e.toToken,e.tokenAmount,e.mode,u==null?void 0:u.address],queryFn:async()=>{const d=new Map,h=a.flatMap(f=>{var g,S,C,b,k;const m=f.getAccount();if(!m)return[];d.set(f,[]);const j=R(e.toToken)?{address:N,name:((g=o.data)==null?void 0:g.nativeCurrency.name)||"",symbol:((S=o.data)==null?void 0:S.nativeCurrency.symbol)||"",icon:(b=(C=o.data)==null?void 0:C.icon)==null?void 0:b.url}:e.toToken,A={...e.sourceSupportedTokens,[e.toChain.id]:[j,...((k=e.sourceSupportedTokens)==null?void 0:k[e.toChain.id])||[]]};return Object.entries(A).flatMap(([v,F])=>F.map(async p=>{try{const B=Se(Number(v)),T=await pe({address:m.address,chain:B,tokenAddress:R(p)?void 0:p.address,client:e.client});if(p.address===j.address&&B.id===e.toChain.id?e.mode==="fund_wallet"&&m.address===(u==null?void 0:u.address)?!1:Number(T.displayValue)>Number(e.tokenAmount):T.value>0n){const M=d.get(f)||[];M.push({balance:T,chain:B,token:p}),M.sort((_,U)=>_.chain.id===e.toChain.id&&_.token.address===j.address?-1:U.chain.id===e.toChain.id&&U.token.address===j.address?1:_.chain.id===e.toChain.id?-1:U.chain.id===e.toChain.id||_.chain.id>U.chain.id?1:-1)}}catch(B){console.error(`Failed to fetch balance for wallet ${f.id} on chain ${v} for token ${p.symbol}:`,B)}}))});return await Promise.all(h),d},enabled:!!e.sourceSupportedTokens&&!!o.data});return i.isLoading||!i.data?t.jsx(de,{}):t.jsxs(l,{children:[t.jsxs(l,{flex:"column",gap:"xs",children:[Array.from(((c=i.data)==null?void 0:c.entries())||[]).filter(([d])=>{var h;return!((h=e.hiddenWallets)!=null&&h.includes(d.id))}).map(([d,h])=>{var m;const f=(m=d.getAccount())==null?void 0:m.address;return f?t.jsx(Jn,{wallet:d,balances:h,client:e.client,address:f,onClick:e.onSelect},d.id):null}),!s&&t.jsx(L,{variant:"secondary",fullWidth:!0,onClick:e.onConnect,gap:"xs",bg:"tertiaryBg",style:{borderRadius:K.lg,border:`1px solid ${n.colors.borderColor}`,padding:I.sm},children:t.jsxs(l,{flex:"row",gap:"sm",center:"y",expand:!0,color:"secondaryIconColor",children:[t.jsx(yn,{size:W.md}),t.jsx(x,{size:"sm",color:"primaryText",children:"Pay with another wallet"})]})}),e.payWithFiatEnabled&&t.jsx(L,{variant:"secondary",fullWidth:!0,gap:"xs",bg:"tertiaryBg",onClick:e.onSelectFiat,style:{borderRadius:K.lg,border:`1px solid ${n.colors.borderColor}`,padding:I.sm},children:t.jsxs(l,{flex:"row",gap:"sm",center:"y",expand:!0,color:"secondaryIconColor",children:[t.jsx(fn,{style:{width:W.md,height:W.md}}),t.jsx(x,{size:"sm",color:"primaryText",children:"Pay with credit card"})]})})]}),t.jsx(y,{y:"sm"})]})}function bs(e){const{title:n,onBack:a,receiverAddress:s,client:o,payer:u,onDone:i,chain:r,token:c,tokenAmount:d,transactionMode:h,setTransactionHash:f,payOptions:m}=e,[j,A]=w.useState("transfer"),[g,S]=w.useState({id:"idle"}),{symbol:C}=jn(r);return t.jsxs(l,{p:"lg",children:[t.jsx(te,{title:n,onBack:a}),t.jsx(y,{y:"xl"}),h&&t.jsxs(t.Fragment,{children:[t.jsx(bt,{steps:2,currentStep:j==="transfer"?1:2}),t.jsx(y,{y:"sm"}),t.jsx(x,{size:"sm",children:j==="transfer"?"Step 1 of 2 - Transfer funds":"Step 2 of 2 - Finalize transaction"}),t.jsx(y,{y:"xl"})]}),t.jsxs(l,{flex:"row",center:"y",style:{justifyContent:"space-between"},children:[t.jsx(x,{size:"sm",children:"From"}),t.jsx(le,{address:u.account.address,client:o})]}),t.jsx(y,{y:"md"}),t.jsx(X,{}),t.jsx(y,{y:"md"}),t.jsxs(l,{flex:"row",center:"y",style:{justifyContent:"space-between"},children:[t.jsx(x,{size:"sm",children:"To"}),t.jsx(le,{address:s,client:o})]}),t.jsx(y,{y:"md"}),t.jsx(X,{}),t.jsx(y,{y:"md"}),t.jsx(gn,{chainId:r.id,client:o,label:"Amount",tokenAmount:d,tokenSymbol:R(c)?C||"":c.symbol,tokenAddress:R(c)?N:c.address}),t.jsx(y,{y:"lg"}),h&&t.jsxs(t.Fragment,{children:[t.jsx(y,{y:"sm"}),t.jsxs(l,{gap:"sm",flex:"row",style:{justifyContent:"space-between"},center:"y",color:"accentText",children:[t.jsx(at,{isDone:j==="execute",isActive:j==="transfer",label:j==="transfer"?"Transfer":"Done"}),t.jsx(bn,{}),t.jsx(at,{isDone:!1,label:"Finalize",isActive:j==="execute"})]}),t.jsx(y,{y:"lg"})]}),g.id==="error"&&t.jsxs(t.Fragment,{children:[t.jsx(l,{flex:"row",gap:"xs",center:"both",color:"danger",children:t.jsx(x,{color:"danger",size:"sm",style:{textAlign:"center"},children:j==="transfer"?`${g.error||"Failed to Transfer"}`:"Failed to Execute"})}),t.jsx(y,{y:"md"})]}),!h&&j==="execute"&&g.id==="done"&&t.jsxs(t.Fragment,{children:[t.jsxs(l,{flex:"row",gap:"xs",center:"both",color:"success",children:[t.jsx(kt,{width:W.sm,height:W.sm}),t.jsx(x,{color:"success",size:"sm",children:"Payment completed"})]}),t.jsx(y,{y:"md"})]}),u.chain.id!==r.id?t.jsx(Tt,{fullWidth:!0,variant:"accent",switchChain:async()=>{await e.payer.wallet.switchChain(r)}}):t.jsxs(L,{variant:"accent",fullWidth:!0,disabled:g.id==="pending",onClick:async()=>{var b;if(j==="execute"){i();return}try{if(S({id:"pending"}),h){const k=R(c)?kn({client:o,chain:r,to:s,value:wn(d)}):Cn({contract:je({address:c.address,chain:r,client:o}),to:s,amount:d});await it({account:e.payer.account,transaction:k}),A("execute"),S({id:"idle"})}else{const k=await qn({client:o,fromAddress:u.account.address,toAddress:s,chainId:r.id,tokenAddress:R(c)?N:c.address,amount:d,purchaseData:m==null?void 0:m.purchaseData});k.approval&&(A("approve"),await it({account:e.payer.account,transaction:k.approval})),A("transfer");const v=k.transactionRequest,F=await dt({account:e.payer.account,transaction:v});f(F.transactionHash),S({id:"idle"})}}catch(k){console.error(k),S({id:"error",error:"error"in k?(b=k.error)==null?void 0:b.message:k==null?void 0:k.message})}},gap:"xs",children:[j==="execute"&&(g.id==="done"?"Done":"Continue"),j==="transfer"&&(g.id==="pending"?"Confirming":"Confirm"),j==="approve"&&(g.id==="pending"?"Approving":"Approve"),g.id==="pending"&&t.jsx(we,{size:"sm",color:"accentButtonText"})]})]})}function ks(e){const[n,a]=w.useState();return n?t.jsx(Sn,{title:e.title,onBack:e.onBack,onTryAgain:e.onTryAgain,swapTxHash:n,client:e.client,onDone:e.onDone,transactionMode:!1,isEmbed:e.isEmbed,quote:void 0,onSuccess:e.onSuccess}):t.jsx(bs,{...e,setTransactionHash:a})}function ws(){const e=We(),n=ke(),a=Ct(),[s,o]=w.useState();return w.useEffect(()=>{const r=s==null?void 0:s.wallet;function c(){if(!r){o(void 0);return}const d=r.getAccount(),h=r.getChain();o(d&&h?{account:d,chain:h,wallet:r}:void 0)}if(r){const d=r.subscribe("chainChanged",c),h=r.subscribe("accountChanged",c);return()=>{d(),h()}}},[s]),{payer:s||(n&&a&&e?{account:n,chain:a,wallet:e}:void 0),setPayer:o}}function zs(e){const n=e.payOptions.buyWithCrypto?e.payOptions.buyWithCrypto.testMode:void 0,a=Tn(e.client,n);return a.isError?t.jsx(l,{style:{minHeight:"350px"},fullHeight:!0,flex:"row",center:"both",children:t.jsx(ft,{title:"Something went wrong",onTryAgain:a.refetch})}):a.data?t.jsx(Cs,{...e,supportedDestinations:a.data}):t.jsx(de,{})}function Cs(e){var ae,oe,ie,re,ce,G,me,Ce,xe,Pe,Le,Me,Ne,_e,qe,$e,Ue,He,Qe,Ge,Ve,Ke,Ye,Ze,Je,Xe,et,tt;const{client:n,supportedDestinations:a,connectLocale:s,payOptions:o}=e;console.log("BuyScreenContent");const u=ke(),{payer:i,setPayer:r}=ws();console.log("payer",i);const[c,d]=w.useState({id:"main"}),{tokenAmount:h,setTokenAmount:f,toChain:m,setToChain:j,deferredTokenAmount:A,toToken:g,setToToken:S}=cs({payOptions:o,supportedDestinations:a}),[C,b]=w.useState(!1),k=w.useCallback(()=>{d({id:"main"}),e.onDone()},[e.onDone]),v=An({client:e.client,destinationChainId:m.id,destinationTokenAddress:R(g)?N:g.address}),F=w.useMemo(()=>rt(a,o,e.supportedTokens),[e.supportedTokens,a,o]),p=w.useMemo(()=>{if(!v.data)return;const z=v.data;return rt(z,o,e.supportedTokens)},[e.supportedTokens,v.data,o]),{fromChain:B,setFromChain:T,fromToken:D,setFromToken:M}=ds({payOptions:o,supportedSources:v.data||[]}),{selectedCurrency:_,setSelectedCurrency:U}=ls({payOptions:o}),q=rs({payOptions:e.payOptions,supportedDestinations:e.supportedDestinations,toChain:m,toToken:g}),P=q.buyWithCryptoEnabled===!1&&q.buyWithFiatEnabled===!1,Z=gt(),ne=w.useCallback(z=>{var O,E;(E=(O=e.payOptions).onPurchaseSuccess)==null||E.call(O,{type:"crypto",status:z}),Ee(Z)},[e.payOptions.onPurchaseSuccess,Z]),he=w.useCallback(z=>{var O,E;(E=(O=e.payOptions).onPurchaseSuccess)==null||E.call(O,{type:"fiat",status:z}),Ee(Z)},[e.payOptions.onPurchaseSuccess,Z]);if(c.id==="connect-payer-wallet")return t.jsx(pn,{accountAbstraction:(ae=e.connectOptions)==null?void 0:ae.accountAbstraction,appMetadata:(oe=e.connectOptions)==null?void 0:oe.appMetadata,chain:(ie=e.connectOptions)==null?void 0:ie.chain,chains:(re=e.connectOptions)==null?void 0:re.chains,client:e.client,connectLocale:e.connectLocale,isEmbed:e.isEmbed,onBack:()=>d(c.backScreen),onSelect:z=>{const O=z.getAccount(),E=z.getChain();z&&O&&E&&r({account:O,chain:E,wallet:z})},hiddenWallets:e.hiddenWallets,recommendedWallets:(ce=e.connectOptions)==null?void 0:ce.recommendedWallets,showAllWallets:((G=e.connectOptions)==null?void 0:G.showAllWallets)===void 0?!0:(me=e.connectOptions)==null?void 0:me.showAllWallets,walletConnect:(Ce=e.connectOptions)==null?void 0:Ce.walletConnect,wallets:(Pe=(xe=e.connectOptions)==null?void 0:xe.wallets)==null?void 0:Pe.filter(z=>z.id!=="inApp")});if(c.id==="swap-flow"&&i)return t.jsx(En,{title:e.title,transactionMode:o.mode==="transaction",isEmbed:e.isEmbed,client:n,onBack:()=>{d({id:"buy-with-crypto"})},buyWithCryptoQuote:c.quote,payer:i,isFiatFlow:!1,onDone:k,onTryAgain:()=>{d({id:"buy-with-crypto"})},onSuccess:ne});if(c.id==="fiat-flow"&&i)return t.jsx(is,{title:e.title,transactionMode:o.mode==="transaction",quote:c.quote,onBack:()=>{d({id:"buy-with-fiat"})},client:n,testMode:e.payOptions.buyWithFiat!==!1&&((Le=e.payOptions.buyWithFiat)==null?void 0:Le.testMode)===!0,theme:typeof e.theme=="string"?e.theme:e.theme.type,openedWindow:c.openedWindow,onDone:k,isEmbed:e.isEmbed,payer:i,onSuccess:he});if(c.id==="transfer-flow"&&i&&u){const z=()=>d({id:"buy-with-crypto"}),E=((Ne=(Me=e.payOptions)==null?void 0:Me.paymentInfo)==null?void 0:Ne.sellerAddress)||u.address;return t.jsx(ks,{title:e.title,onBack:z,payer:i,client:e.client,chain:m,token:g,tokenAmount:h,receiverAddress:E,transactionMode:e.payOptions.mode==="transaction",payOptions:o,isEmbed:e.isEmbed,onDone:k,onTryAgain:()=>{d({id:"buy-with-crypto"})},onSuccess:ne})}if(c.id==="select-currency"){const z=()=>d(c.backScreen);return t.jsx(ns,{onSelect:O=>{z(),U(O)},onBack:z})}if(c.id==="select-to-token"){const z=a.map(Q=>Q.chain),O=()=>d(c.backScreen),E=(_e=o==null?void 0:o.prefillBuy)==null?void 0:_e.allowEdits;return(E==null?void 0:E.token)===!1?t.jsx(ct,{chains:z,client:e.client,connectLocale:e.connectLocale,setChain:j,goBack:O}):t.jsx(ot,{onBack:O,tokenList:((m!=null&&m.id?F[m.id]:void 0)||[]).filter(Q=>Q.address!==N),onTokenSelect:Q=>{S(Q),O()},chain:m,chainSelection:(E==null?void 0:E.chain)!==!1?{chains:z,select:Q=>{j(Q)}}:void 0,connectLocale:s,client:n,modalTitle:e.title})}if(c.id==="select-from-token"&&v.data&&p){const z=v.data.map(E=>E.chain),O=()=>d(c.backScreen);return o.buyWithCrypto!==!1&&((Ue=($e=(qe=o.buyWithCrypto)==null?void 0:qe.prefillSource)==null?void 0:$e.allowEdits)==null?void 0:Ue.token)===!1?t.jsx(ct,{chains:z,client:e.client,connectLocale:e.connectLocale,setChain:T,goBack:O}):t.jsx(ot,{onBack:O,tokenList:((B!=null&&B.id?p[B.id]:void 0)||[]).filter(E=>E.address!==N),onTokenSelect:E=>{M(E),O()},chain:B,chainSelection:o.buyWithCrypto!==!1&&((Ge=(Qe=(He=o.buyWithCrypto)==null?void 0:He.prefillSource)==null?void 0:Qe.allowEdits)==null?void 0:Ge.chain)!==!1?{chains:v.data.map(E=>E.chain),select:E=>T(E)}:void 0,connectLocale:s,client:n,modalTitle:"Pay with"})}return console.log("SCREEN",c.id),t.jsx(l,{animate:"fadein",children:t.jsxs("div",{children:[c.id==="main"&&t.jsx(Ts,{title:e.title,payerAccount:i==null?void 0:i.account,client:n,onSelectBuyToken:()=>d({id:"select-to-token",backScreen:c}),payOptions:o,setTokenAmount:f,setToChain:j,setToToken:S,setFromChain:T,setFromToken:M,toChain:m,toToken:g,tokenAmount:h,connectOptions:e.connectOptions,setScreen:d,supportedDestinations:a,onBack:e.onBack,theme:e.theme,hasEditedAmount:C,setHasEditedAmount:b,enabledPaymentMethods:q}),(c.id==="select-payment-method"||c.id==="buy-with-crypto"||c.id==="buy-with-fiat")&&i&&t.jsxs(As,{title:e.title,selectedChain:m,selectedToken:g,tokenAmount:h,client:n,onBack:()=>{q.buyWithCryptoEnabled&&c.id==="buy-with-fiat"?d({id:"select-payment-method"}):c.id==="buy-with-crypto"?d({id:"select-payment-method"}):d({id:"main"})},children:[c.id==="select-payment-method"&&t.jsx(gs,{client:n,mode:o.mode,sourceSupportedTokens:p,hiddenWallets:e.hiddenWallets,payWithFiatEnabled:e.payOptions.buyWithFiat!==!1,toChain:m,toToken:g,tokenAmount:h,onSelect:(z,O,E)=>{const Q=z.getAccount();Q&&(r({account:Q,chain:E,wallet:z}),M(O),T(E),d({id:"buy-with-crypto"}))},onSelectFiat:()=>{d({id:"buy-with-fiat"})},showAllWallets:!!((Ve=e.connectOptions)!=null&&Ve.showAllWallets),wallets:(Ke=e.connectOptions)==null?void 0:Ke.wallets,onBack:()=>{},onConnect:()=>{d({id:"connect-payer-wallet",backScreen:{id:"select-payment-method"}})}}),c.id==="buy-with-crypto"&&u&&t.jsx(ps,{setScreen:d,tokenAmount:A,toChain:m,toToken:g,fromChain:B,fromToken:D,showFromTokenSelector:()=>{d({id:"select-from-token",backScreen:c})},payer:i,client:n,isEmbed:e.isEmbed,onDone:k,payOptions:o,connectLocale:s,connectOptions:e.connectOptions,setPayer:r,activeAccount:u,setTokenAmount:f,setHasEditedAmount:b,disableTokenSelection:P===!0||o.buyWithCrypto!==!1&&((Je=(Ze=(Ye=o.buyWithCrypto)==null?void 0:Ye.prefillSource)==null?void 0:Ze.allowEdits)==null?void 0:Je.chain)===!1&&((tt=(et=(Xe=o.buyWithCrypto)==null?void 0:Xe.prefillSource)==null?void 0:et.allowEdits)==null?void 0:tt.token)===!1}),c.id==="buy-with-fiat"&&t.jsx(Es,{setScreen:d,tokenAmount:A,toChain:m,toToken:g,selectedCurrency:_,client:n,isEmbed:e.isEmbed,onDone:k,payOptions:o,theme:e.theme,showCurrencySelector:()=>{d({id:"select-currency",backScreen:c})},payer:i,setTokenAmount:f,setHasEditedAmount:b})]})]})})}function Ss(e){return t.jsx("div",{children:t.jsxs(l,{flex:"row",gap:"sm",center:"y",style:{justifyContent:"space-between"},children:[t.jsxs(l,{flex:"row",gap:"xs",center:"y",children:[t.jsx(x,{color:"primaryText","data-testid":"tokenAmount",size:"xl",children:$(Number(e.tokenAmount),6)}),t.jsxs(l,{flex:"row",gap:"xxs",center:"y",children:[t.jsx(Y,{token:e.selectedToken,chain:e.selectedChain,size:"md",color:"secondaryText"}),t.jsx(St,{chain:e.selectedChain,client:e.client,size:"sm",token:e.selectedToken})]})]}),t.jsx(vn,{chain:e.selectedChain,client:e.client,size:"sm",short:!0})]})})}function Ts(e){var C,b,k,v,F,p;const{setTokenAmount:n,setToChain:a,setToToken:s,setFromChain:o,setFromToken:u,payerAccount:i,client:r,tokenAmount:c,payOptions:d,toToken:h,toChain:f,supportedDestinations:m,enabledPaymentMethods:j}=e,{buyWithCryptoEnabled:A,buyWithFiatEnabled:g}=j,S=!c;switch(d.mode){case"transaction":return t.jsx(ts,{supportedDestinations:m,payUiOptions:d,payerAccount:i,connectOptions:e.connectOptions,client:r,onContinue:(B,T,D)=>{n(B),a(T),o(T),u(D),s(D),g&&!A?e.setScreen({id:"buy-with-fiat"}):e.setScreen({id:"select-payment-method"})}});case"direct_payment":return t.jsx(Vn,{client:r,payUiOptions:d,payerAccount:i,connectOptions:e.connectOptions,supportedDestinations:m,onContinue:(B,T,D)=>{n(B),a(T),o(T),u(D),s(D),g&&!A?e.setScreen({id:"buy-with-fiat"}):e.setScreen({id:"select-payment-method"})}});default:return t.jsxs(l,{p:"lg",children:[t.jsx(te,{title:e.title,onBack:e.onBack}),t.jsx(y,{y:"xl"}),t.jsx(ms,{value:c,onChange:async B=>{e.setHasEditedAmount(!0),n(B)},freezeAmount:((b=(C=d.prefillBuy)==null?void 0:C.allowEdits)==null?void 0:b.amount)===!1,freezeChainAndToken:((v=(k=d.prefillBuy)==null?void 0:k.allowEdits)==null?void 0:v.chain)===!1&&((p=(F=d.prefillBuy)==null?void 0:F.allowEdits)==null?void 0:p.token)===!1,token:h,chain:f,onSelectToken:e.onSelectBuyToken,client:e.client}),t.jsx(y,{y:"xl"}),t.jsx(l,{flex:"column",gap:"sm",children:i?t.jsx(L,{variant:"accent",fullWidth:!0,disabled:S,"data-disabled":S,onClick:()=>{g&&!A?e.setScreen({id:"buy-with-fiat"}):e.setScreen({id:"select-payment-method"})},children:"Continue"}):t.jsx("div",{children:t.jsx(Ie,{...e.connectOptions,client:e.client,theme:e.theme,connectButton:{style:{width:"100%"}}})})})]})}}function As(e){return t.jsxs(l,{children:[t.jsx(l,{p:"lg",children:t.jsx(te,{title:e.title,onBack:e.onBack})}),t.jsxs(l,{px:"lg",style:{paddingBottom:I.lg},children:[t.jsx(y,{y:"xs"}),t.jsx(Ss,{selectedToken:e.selectedToken,selectedChain:e.selectedChain,tokenAmount:e.tokenAmount,client:e.client}),t.jsx(y,{y:"md"}),t.jsx(X,{}),t.jsx(y,{y:"lg"}),t.jsx(x,{size:"sm",children:" Pay with "}),t.jsx(y,{y:"sm"}),e.children]})]})}function ps(e){var he,ae,oe,ie,re,ce;const{setScreen:n,payer:a,client:s,toChain:o,tokenAmount:u,toToken:i,fromChain:r,fromToken:c,payOptions:d,disableTokenSelection:h}=e,m=((ae=(he=e.payOptions)==null?void 0:he.paymentInfo)==null?void 0:ae.sellerAddress)||e.activeAccount.address,{drawerRef:j,drawerOverlayRef:A,isOpen:g,setIsOpen:S}=Bt(),[C,b]=w.useState("fees"),k=De({address:a.account.address,chain:r,tokenAddress:R(c)?void 0:c.address,client:s}),v=R(c)?N:c.address.toLowerCase(),F=R(i)?N:i.address.toLowerCase(),p=!!u&&!(r.id===o.id&&v===F),B=p?{fromAddress:a.account.address,toAddress:m,fromChainId:r.id,fromTokenAddress:R(c)?N:c.address,toChainId:o.id,toTokenAddress:R(i)?N:i.address,toAmount:u,client:s,purchaseData:d.purchaseData}:void 0,T=$n(B,{staleTime:30*1e3,refetchInterval:30*1e3,gcTime:30*1e3}),D=p?(oe=T.data)==null?void 0:oe.swapDetails.fromAmount:u,M=!!D&&!!k.data&&Number(k.data.displayValue)<Number(D),_=p&&!T.data||M,U=((ie=e.payer.wallet.getChain())==null?void 0:ie.id)!==r.id;function q(G){const me="Unable to get price quote";try{if(G.error.code==="MINIMUM_PURCHASE_AMOUNT"){const xe=G.error.data.minimumAmountEth;return{minAmount:$(Number(xe),6)}}}catch{}return{msg:[me]}}const P=!T.isLoading&&T.error?q(T.error):void 0;function Z(){if((e.payOptions.mode==="direct_payment"||e.payOptions.mode==="fund_wallet")&&!M&&!p)n({id:"transfer-flow"});else if(e.payOptions.mode==="transaction"&&!M&&!p){a.account.address!==m?n({id:"transfer-flow"}):e.onDone();return}T.data&&n({id:"swap-flow",quote:T.data})}function ne(){T.data&&(S(!0),b("fees"))}return t.jsxs(l,{flex:"column",gap:"md",animate:"fadein",children:[g&&t.jsxs(t.Fragment,{children:[t.jsx(Et,{ref:A}),t.jsx(pt,{ref:j,close:()=>S(!1),children:C==="fees"&&T.data&&t.jsxs("div",{children:[t.jsx(x,{size:"lg",color:"primaryText",children:"Fees"}),t.jsx(y,{y:"lg"}),t.jsx(ys,{quote:T.data})]})})]}),t.jsxs("div",{children:[t.jsx(js,{value:D||"",chain:r,token:c,isLoading:T.isLoading&&!D,client:s,freezeChainAndTokenSelection:h,payerAccount:e.payer.account,swapRequired:p}),p&&t.jsx(Wt,{quoteIsLoading:T.isLoading,estimatedSeconds:(re=T.data)==null?void 0:re.swapDetails.estimated.durationSeconds,onViewFees:ne}),t.jsx(y,{y:"md"})]}),P&&t.jsxs("div",{children:[P.minAmount&&t.jsxs(x,{color:"danger",size:"sm",center:!0,multiline:!0,children:["Minimum amount is ",P.minAmount," ",t.jsx(Y,{token:i,chain:o,size:"sm",inline:!0,color:"danger"})]}),(ce=P.msg)==null?void 0:ce.map(G=>t.jsx(x,{color:"danger",size:"sm",center:!0,multiline:!0,children:G},G))]}),!P&&M&&t.jsxs("div",{children:[t.jsx(x,{color:"danger",size:"sm",center:!0,multiline:!0,children:"Not enough funds."}),t.jsx(x,{color:"danger",size:"sm",center:!0,multiline:!0,children:"Try a different wallet or token."})]}),P!=null&&P.minAmount?t.jsx(L,{variant:"accent",fullWidth:!0,onClick:()=>{e.setTokenAmount(String(P.minAmount)),e.setHasEditedAmount(!0)},children:"Set Minimum"}):U&&!T.isLoading&&!M&&!T.error?t.jsx(Tt,{variant:"accent",fullWidth:!0,switchChain:async()=>{await e.payer.wallet.switchChain(r)}}):t.jsx(L,{variant:_?"outline":"accent",fullWidth:!0,"data-disabled":_,disabled:_,onClick:async()=>{_||Z()},gap:"xs",children:T.isLoading?t.jsxs(t.Fragment,{children:["Getting price quote",t.jsx(we,{size:"sm",color:"accentText"})]}):"Continue"})]})}function Es(e){var T,D,M,_,U;const{toToken:n,tokenAmount:a,payer:s,client:o,setScreen:u,toChain:i,showCurrencySelector:r,selectedCurrency:c}=e,h=((D=(T=e.payOptions)==null?void 0:T.paymentInfo)==null?void 0:D.sellerAddress)||e.payer.account.address,{drawerRef:f,drawerOverlayRef:m,isOpen:j,setIsOpen:A}=Bt(),[g,S]=w.useState("fees"),C=e.payOptions.buyWithFiat,b=Hn(C!==!1&&a?{fromCurrencySymbol:c.shorthand,toChainId:i.id,toAddress:h,toTokenAddress:R(n)?N:n.address,toAmount:a,client:o,isTestMode:C==null?void 0:C.testMode,purchaseData:e.payOptions.purchaseData,fromAddress:s.account.address,preferredProvider:C==null?void 0:C.preferredProvider}:void 0);function k(){if(!b.data)return;const q=At(b.data);let P=null;q||(P=Ft(b.data.onRampLink,typeof e.theme=="string"?e.theme:e.theme.type),wt({type:"fiat",intentId:b.data.intentId})),u({id:"fiat-flow",quote:b.data,openedWindow:P})}function v(){b.data&&(S("fees"),A(!0))}function F(q){const P="Unable to get price quote";try{if(q.error.code==="MINIMUM_PURCHASE_AMOUNT"){const ne=q.error.data.minimumAmountEth;return{minAmount:$(Number(ne),6)}}}catch{}return{msg:[P]}}const p=!b.data,B=!b.isLoading&&b.error?F(b.error):void 0;return t.jsxs(l,{flex:"column",gap:"md",animate:"fadein",children:[j&&t.jsxs(t.Fragment,{children:[t.jsx(Et,{ref:m}),t.jsx(pt,{ref:f,close:()=>A(!1),children:g==="fees"&&b.data&&t.jsxs("div",{children:[t.jsx(x,{size:"lg",color:"primaryText",children:"Fees"}),t.jsx(y,{y:"lg"}),t.jsx(fs,{quote:b.data})]})})]}),t.jsxs("div",{children:[t.jsx(Yn,{isLoading:b.isLoading,value:(M=b.data)==null?void 0:M.fromCurrencyWithFees.amount,client:o,currency:c,onSelectCurrency:r}),t.jsx(Wt,{quoteIsLoading:b.isLoading,estimatedSeconds:(_=b.data)==null?void 0:_.estimatedDurationSeconds,onViewFees:v}),t.jsx(y,{y:"md"})]}),B&&t.jsxs("div",{children:[B.minAmount&&t.jsxs(x,{color:"danger",size:"sm",center:!0,multiline:!0,children:["Minimum amount is ",B.minAmount," ",t.jsx(Y,{token:n,chain:i,size:"sm",inline:!0,color:"danger"})]}),(U=B.msg)==null?void 0:U.map(q=>t.jsx(x,{color:"danger",size:"sm",center:!0,multiline:!0,children:q},q))]}),B!=null&&B.minAmount?t.jsx(L,{variant:"accent",fullWidth:!0,onClick:()=>{e.setTokenAmount(String(B.minAmount)),e.setHasEditedAmount(!0)},children:"Set Minimum"}):t.jsx(L,{variant:p?"outline":"accent","data-disabled":p,disabled:p,fullWidth:!0,onClick:k,gap:"xs",children:b.isLoading?t.jsxs(t.Fragment,{children:["Getting price quote",t.jsx(we,{size:"sm",color:"accentText"})]}):"Continue"})]})}function rt(e,n,a){const s={},o=n.buyWithFiat===!1,u=n.buyWithCrypto===!1;for(const i of e)s[i.chain.id]=i.tokens.filter(r=>r.buyWithCryptoEnabled===void 0&&r.buyWithFiatEnabled===void 0||r.buyWithCryptoEnabled&&r.buyWithFiatEnabled?!0:!(!r.buyWithCryptoEnabled&&o||!r.buyWithFiatEnabled&&u));if(a)for(const i in a){const r=Number(i),c=a[r];c&&(s[r]=c)}return s}function ct(e){return t.jsx(Bn,{client:e.client,connectLocale:e.connectLocale,showTabs:!1,onBack:e.goBack,chains:e.chains,closeModal:e.goBack,networkSelector:{renderChain(n){return t.jsx(Wn,{chain:n.chain,confirming:!1,switchingFailed:!1,onClick:()=>{e.setChain(n.chain),e.goBack()},client:e.client,connectLocale:e.connectLocale})}}})}export{zs as default};
